<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¶„ì„ ë³´ìœ¤ì„ (boonseok)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background:#f5f6fa; color:#333; }
    .container { max-width: 1200px; margin: 24px auto; padding: 0 16px; }
    h1 { margin-bottom: 8px; font-size: 1.8rem; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.2rem; }
    h4 { font-size: 1rem; }
    .note { color:#666; margin-bottom: 24px; font-size: 0.95rem; }
    .section { background:#fff; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,.06); padding: 20px; margin-bottom: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 16px; }
    .controls { display:flex; flex-wrap: wrap; gap: 12px; margin-bottom: 12px; align-items: center; }
    select, button { padding: 8px 10px; border-radius: 8px; border:1px solid #d7dce3; background:#fff; font-size: 14px; }
    button { background:#667eea; color:#fff; border:0; cursor:pointer; }
    button.secondary { background:#c9d1e9; color:#233; }
    table { width: 100%; border-collapse: collapse; font-size: 14px; }
    th, td { padding: 10px 12px; border-bottom: 1px solid #eee; text-align: left; }
    th { background:#f7f8fb; font-size: 13px; }
    .pill { display:inline-block; padding: 2px 8px; border-radius: 16px; background:#eef; color:#334; font-size: 12px; }
    .muted { color:#666; }
    .list { max-height: 360px; overflow:auto; }
    .tag { display:inline-block; padding:2px 6px; margin:2px; background:#eef3ff; border-radius: 10px; font-size: 12px; }
    
    /* ë¹„ë°€ë²ˆí˜¸ ë³´í˜¸ ìŠ¤íƒ€ì¼ */
    .password-section { background:#fff; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,.06); padding: 24px; margin-bottom: 20px; text-align: center; }
    .password-input { padding: 10px 15px; border: 2px solid #667eea; border-radius: 8px; font-size: 16px; width: 200px; margin-right: 10px; }
    .password-button { padding: 10px 20px; background:#667eea; color:#fff; border:0; border-radius: 8px; font-size: 16px; cursor:pointer; }
    .password-button:hover { background:#5a6fd8; }
    .password-error { color: #ff6b6b; margin-top: 10px; display: none; }
    .password-success { color: #4ecdc4; margin-top: 10px; display: none; }
    .protected-content { display: none; }
    .protected-content.unlocked { display: block; }
    .blur-content { filter: blur(5px); pointer-events: none; user-select: none; }
    
    /* í…Œì´ë¸” ìŠ¤í¬ë¡¤ ë˜í¼ */
    .table-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    
    /* ëª¨ë°”ì¼ ìµœì í™” */
    @media (max-width: 768px) {
      .container { padding: 0 12px; margin: 12px auto; }
      h1 { font-size: 1.5rem; }
      h2 { font-size: 1.3rem; }
      h3 { font-size: 1.1rem; }
      h4 { font-size: 0.95rem; }
      .section { padding: 16px; margin-bottom: 16px; }
      .grid { grid-template-columns: 1fr; gap: 12px; }
      .controls { gap: 8px; }
      select, button { padding: 10px 12px; font-size: 14px; width: 100%; }
      .password-input { width: 100%; margin-right: 0; margin-bottom: 10px; }
      .password-button { width: 100%; }
      table { font-size: 12px; }
      th, td { padding: 8px 6px; font-size: 11px; }
      .list { max-height: 250px; font-size: 13px; }
      canvas { max-height: 300px !important; }
      .note { font-size: 0.85rem; }
      /* ë¬¸í•­ìˆ˜ì¤€ë¶„ì„ ê·¸ë˜í”„ ëª¨ë°”ì¼ ë¹„ìœ¨ ì¡°ì • */
      #itemBarChart { min-height: 400px !important; height: 400px !important; max-height: 400px !important; }
    }
    
    @media (max-width: 480px) {
      .container { padding: 0 8px; }
      h1 { font-size: 1.3rem; }
      h2 { font-size: 1.15rem; }
      .section { padding: 12px; }
      table { font-size: 11px; }
      th, td { padding: 6px 4px; font-size: 10px; word-break: break-word; }
      .pill { font-size: 10px; padding: 1px 6px; }
      .tag { font-size: 10px; }
      /* ì†Œí˜• ëª¨ë°”ì¼ì—ì„œ ë¬¸í•­ìˆ˜ì¤€ë¶„ì„ ê·¸ë˜í”„ ì¶”ê°€ ì¡°ì • */
      #itemBarChart { min-height: 350px !important; height: 350px !important; max-height: 350px !important; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ë¶„ì„ ë³´ìœ¤ì„</h1>
    <div class="note">ì„¸ ê°€ì§€ ë¶„ì„(í•˜ìœ„ê·¸ë£¹, ë¬¸í•­ìˆ˜ì¤€, ë‚´ìš©ë¶„ì„)ì„ ì¼ê´„ ì‹¤í–‰í•©ë‹ˆë‹¤. <span id="participant-info" style="color: #667eea; font-weight: bold;"></span></div>

    <!-- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ ì„¹ì…˜ -->
    <div class="password-section" id="passwordSection">
      <h2>ğŸ”’ ì£¼ê´€ì‹ ë‹µë³€ ë³´í˜¸</h2>
      <p style="color: #666; margin-bottom: 20px;">ì£¼ê´€ì‹ ë‹µë³€ì„ ë³´ì‹œë ¤ë©´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
      <div>
        <input type="password" id="passwordInput" class="password-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" />
        <button class="password-button" onclick="checkPassword()">í™•ì¸</button>
      </div>
      <div id="passwordError" class="password-error">âŒ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</div>
      <div id="passwordSuccess" class="password-success">âœ… ì¸ì¦ë˜ì—ˆìŠµë‹ˆë‹¤! ì£¼ê´€ì‹ ë‹µë³€ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    </div>

    <div class="section" id="statusBox">
      <div id="statusText">Firebaseì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
    </div>

    <div class="section">
      <h2>ë°©ë²• 1. í•˜ìœ„ê·¸ë£¹ ë¶„ì„ (Subgroup Analysis)</h2>
      <div class="controls">
        <label>ê·¸ë£¹ ê¸°ì¤€:
          <select id="subgroup-dimension">
            <option value="external_internal">ì „ëµ1: ìì¡´ê°ì˜ ì›ì²œ (ì™¸ì ë™ê¸° vs ë‚´ì ë™ê¸°)</option>
            <option value="personality">ì „ëµ2: ê¸°ë³¸ì„±ê²© (ë‚™ê´€ vs ì‹ ì¤‘/ëƒ‰ì†Œ)</option>
            <option value="emotion_style">ì „ëµ3: ê°ì •í‘œí˜„ (ì–µì œ/ë‚´ë©´í™” vs ì¦‰ì‹œ/ì†”ì§)</option>
          </select>
        </label>
        <label>ì‚¬í›„ íŒŒì¥:
          <select id="subgroup-postwave">
            <option value="fourth">4ì°¨</option>
            <option value="third">3ì°¨</option>
          </select>
        </label>
        <button id="runSubgroup">ë¶„ì„ ì‹¤í–‰</button>
      </div>
      <div class="grid">
        <div>
          <canvas id="subgroupDeltaChart" style="margin-bottom:16px;"></canvas>
          <canvas id="subgroupPrePostChart"></canvas>
        </div>
        <div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ì¹´í…Œê³ ë¦¬</th>
                  <th id="sub-hA">ê·¸ë£¹A Î”í‰ê· </th>
                  <th id="sub-hB">ê·¸ë£¹B Î”í‰ê· </th>
                  <th>t(ì›°ì¹˜)</th>
                  <th>df</th>
                  <th>p(ì–‘ì¸¡)</th>
                </tr>
              </thead>
              <tbody id="subgroupTable"></tbody>
            </table>
          </div>
          <div style="height:12px;"></div>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ì¹´í…Œê³ ë¦¬</th>
                  <th id="sub-hA-pre">ê·¸ë£¹A 1ì°¨</th>
                  <th id="sub-hA-post">ê·¸ë£¹A ì‚¬í›„</th>
                  <th id="sub-hB-pre">ê·¸ë£¹B 1ì°¨</th>
                  <th id="sub-hB-post">ê·¸ë£¹B ì‚¬í›„</th>
                </tr>
              </thead>
              <tbody id="subgroupPrePostTable"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ë°©ë²• 2. ë¬¸í•­ìˆ˜ì¤€ ë¶„ì„ (Item-level Analysis)</h2>
      <div class="controls">
        <label>ì²™ë„ ì„ íƒ:
          <select id="item-scale">
            <option value="ìê¸° ìˆ˜ìš©">ìê¸° ìˆ˜ìš©</option>
            <option value="ë‚´ì  ë§¤ë ¥ ì¸ì§€ ëª…í™•ì„±">ë‚´ì  ë§¤ë ¥ ì¸ì§€ ëª…í™•ì„±</option>
            <option value="ê´€ê³„ì  ìì‹ ê°">ê´€ê³„ì  ìì‹ ê°</option>
            <option value="ë¡œì  ë²„ê·¸ ìì•„ì¡´ì¤‘ê° ì²™ë„">ë¡œì  ë²„ê·¸ ìì•„ì¡´ì¤‘ê° ì²™ë„</option>
            <option value="ì¼ë°˜ì  ìê¸°íš¨ëŠ¥ê° ì²™ë„">ì¼ë°˜ì  ìê¸°íš¨ëŠ¥ê° ì²™ë„</option>
          </select>
        </label>
        <label>ì‚¬í›„ íŒŒì¥:
          <select id="item-postwave">
            <option value="fourth">4ì°¨</option>
            <option value="third">3ì°¨</option>
          </select>
        </label>
        <button id="runItem">ë¶„ì„ ì‹¤í–‰</button>
      </div>
      <div class="grid">
        <div style="min-height: 600px;">
          <canvas id="itemBarChart" style="height: 100%; min-height: 600px;"></canvas>
        </div>
        <div>
          <div class="list" id="itemInsights"></div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ë°©ë²• 3. 1ì°¨-4ì°¨ ëŒ€ì‘í‘œë³¸ ë¹„êµë¶„ì„ (Paired Sample Analysis)</h2>
      <div class="note">1ì°¨ì™€ 4ì°¨ ì„¤ë¬¸ ê²°ê³¼ë¥¼ ì§ì ‘ ë¹„êµí•˜ì—¬ ëŒ€ì‘í‘œë³¸ Tê²€ì •ê³¼ Cohen's d íš¨ê³¼í¬ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</div>
      <div class="controls">
        <button id="runPairedAnalysis">1ì°¨-4ì°¨ ëŒ€ì‘í‘œë³¸ ë¶„ì„ ì‹¤í–‰</button>
        <button class="secondary" id="exportPairedResults">ê²°ê³¼ ë‚´ë³´ë‚´ê¸°</button>
      </div>
      <div class="grid">
        <div>
          <canvas id="pairedComparisonChart" style="margin-bottom:16px;"></canvas>
          <canvas id="pairedEffectSizeChart"></canvas>
        </div>
        <div>
          <div>
            <h3>ê°œë³„ ì°¸ê°€ì ë³€í™”</h3>
            <div class="list" id="individualChanges"></div>
          </div>
        </div>
      </div>
      
      <!-- ëŒ€ì‘í‘œë³¸ Tê²€ì • ê²°ê³¼ í‘œë¥¼ ì°¨íŠ¸ ì•„ë˜ë¡œ ì´ë™ -->
      <div style="margin-top: 24px;">
        <h3>ëŒ€ì‘í‘œë³¸ Tê²€ì • ê²°ê³¼</h3>
        <div style="overflow-x: auto;">
          <table>
            <thead>
              <tr>
                <th>ì²™ë„</th>
                <th>1ì°¨ í‰ê· (SD)</th>
                <th>4ì°¨ í‰ê· (SD)</th>
                <th>í‰ê· ì°¨ì´</th>
                <th>tê°’</th>
                <th>df</th>
                <th>pê°’</th>
                <th>Cohen's d</th>
                <th>íš¨ê³¼í¬ê¸°</th>
              </tr>
            </thead>
            <tbody id="pairedTTestTable"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ë°©ë²• 4. 2ì°¨ ì„¤ë¬¸ ì‘ë‹µ ë¶„ì„ (í”„ë¡œê·¸ë¨ ì¢…ë£Œ ì§í›„)</h2>
      <div class="note">2ì°¨ ì„¤ë¬¸ì˜ ë§Œì¡±ë„ ë° í‰ê°€ ë¬¸í•­ ë¶„ì„</div>
      <div class="controls">
        <button id="runSecondAnalysis">2ì°¨ ì„¤ë¬¸ ë¶„ì„ ì‹¤í–‰</button>
      </div>
      <div class="grid">
        <div>
          <canvas id="secondSurveyChart"></canvas>
        </div>
        <div>
          <div>
            <h3>í†µê³„ ìš”ì•½</h3>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>ì§ˆë¬¸</th>
                    <th>í‰ê· </th>
                    <th>í‘œì¤€í¸ì°¨</th>
                    <th>ìµœì†Œ</th>
                    <th>ìµœëŒ€</th>
                  </tr>
                </thead>
                <tbody id="secondStatsTable"></tbody>
              </table>
            </div>
          </div>
          <div style="margin-top: 16px;" class="protected-content">
            <h3>ê¸ì •ì  ê²½í—˜ ë° ê¹¨ë‹¬ìŒ (ì£¼ê´€ì‹)</h3>
            <div class="list" id="secondExperiencesList"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ë°©ë²• 5. 3ì°¨ ì„¤ë¬¸ ì‘ë‹µ ë¶„ì„ (3ì£¼ í›„)</h2>
      <div class="note">3ì°¨ ì„¤ë¬¸ì˜ ì¶”ì  ì§ˆë¬¸ ë° ì£¼ê´€ì‹ ì‘ë‹µ ë¶„ì„</div>
      <div class="controls">
        <button id="runThirdAnalysis">3ì°¨ ì„¤ë¬¸ ë¶„ì„ ì‹¤í–‰</button>
      </div>
      <div class="grid">
        <div>
          <canvas id="thirdSurveyChart"></canvas>
        </div>
        <div>
          <div>
            <h3>í†µê³„ ìš”ì•½ (Q1~Q5)</h3>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>ì§ˆë¬¸</th>
                    <th>í‰ê· </th>
                    <th>í‘œì¤€í¸ì°¨</th>
                    <th>ìµœì†Œ</th>
                    <th>ìµœëŒ€</th>
                  </tr>
                </thead>
                <tbody id="thirdStatsTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <div style="margin-top: 16px;" class="protected-content">
        <h3>ì£¼ê´€ì‹ ì‘ë‹µ</h3>
        <div class="grid">
          <div>
            <h4>Q6, Q7: ìµœê·¼ 3ì£¼ ê¸ì •ì  ë³€í™”/ê²½í—˜</h4>
            <div class="list" id="thirdQ6Q7List"></div>
          </div>
          <div>
            <h4>Q10~Q12: ììœ ì„œìˆ </h4>
            <div class="list" id="thirdQ10Q12List"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•¨ìˆ˜
    function checkPassword() {
      const input = document.getElementById('passwordInput');
      const password = input.value;
      const errorMsg = document.getElementById('passwordError');
      const successMsg = document.getElementById('passwordSuccess');
      const protectedContents = document.querySelectorAll('.protected-content');
      const passwordSection = document.getElementById('passwordSection');
      
      if (password === '0515') {
        // ë¹„ë°€ë²ˆí˜¸ ì •í™•
        errorMsg.style.display = 'none';
        successMsg.style.display = 'block';
        
        // ì£¼ê´€ì‹ ë‹µë³€ ì ê¸ˆ í•´ì œ
        protectedContents.forEach(content => {
          content.classList.add('unlocked');
        });
        
        // ë¹„ë°€ë²ˆí˜¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
        setTimeout(() => {
          passwordSection.style.display = 'none';
        }, 1500);
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ìƒˆë¡œê³ ì¹¨í•´ë„ ìœ ì§€)
        localStorage.setItem('qualitativeUnlocked', 'true');
      } else {
        // ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜
        errorMsg.style.display = 'block';
        successMsg.style.display = 'none';
        input.value = '';
        input.focus();
      }
    }
    
    // Enter í‚¤ë¡œ ë¹„ë°€ë²ˆí˜¸ í™•ì¸
    document.addEventListener('DOMContentLoaded', () => {
      const input = document.getElementById('passwordInput');
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          checkPassword();
        }
      });
      
      // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì¸ì¦ ìƒíƒœ í™•ì¸
      if (localStorage.getItem('qualitativeUnlocked') === 'true') {
        const protectedContents = document.querySelectorAll('.protected-content');
        protectedContents.forEach(content => {
          content.classList.add('unlocked');
        });
        document.getElementById('passwordSection').style.display = 'none';
      }
    });
  </script>

  <script type="module" src="script.js"></script>
</body>
</html>
